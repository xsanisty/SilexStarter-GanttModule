{% set template = config.get('@silexstarter-dashboard.config.template') %}
{% extends '@silexstarter-dashboard/'~ template ~'/index.twig' %}

{% block stylesheet %}
    {{parent()}}

    {% if config.get('@xsanisty-gantt.gantt.pro_version_enabled') %}
        {{ stylesheet('@xsanisty-gantt/pro/dhtmlxgantt.css') }}
    {% else %}
        {{ stylesheet('@xsanisty-gantt/css/dhtmlxgantt.css') }}
    {% endif %}

    <style>
        html, body{ height:100%; padding:0px; margin:0px;}
        .gantt_task_line.gantt_dependent_task {
            background-color: #65c16f;
            border: 1px solid #3c9445;

        }
        .gantt_task_line.gantt_dependent_task .gantt_task_progress {
            background-color: #46ad51;
        }

        .content-wrapper, .right-side, .main-footer {
            margin-left: 0 !important;
        }
    </style>
{% endblock %}

{% block sidebar %}{% endblock %}
{% block navbar %}{% endblock %}
{% block breadcrumb %}{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-md-12">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">{{ chart.name }}</h3>
                    <div class="box-tools pull-right">
                        <button class="btn btn-box-tool" data-toggle="tooltip" title="refresh chart" type="button" id="btn-refresh"><i class="fa fa-refresh"></i></button>
                        <button class="btn btn-box-tool" data-toggle="tooltip" title="export to pdf" type="button" id="btn-export-pdf" onclick="gantt.exportToPDF()"><i class="fa fa-file-pdf-o"></i></button>
                        <button class="btn btn-box-tool" data-toggle="tooltip" title="export to png" type="button" id="btn-export-png" onclick="gantt.exportToPNG()"><i class="fa fa-image"></i></button>
                    </div>
                </div>
                <div class="box-body no-padding">
                    <div id="gantt-container" style="width:100%; height:520px;"></div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascript %}
    {{parent()}}

    {% if config.get('@xsanisty-gantt.gantt.pro_version_enabled') %}
        {{ javascript('@xsanisty-gantt/pro/dhtmlxgantt.js') }}
    {% else %}
        {{ javascript('@xsanisty-gantt/js/dhtmlxgantt.js') }}
    {% endif %}


    {{ javascript(['@xsanisty-gantt/js/ext/dhtmlxgantt_quick_info.js','http://export.dhtmlx.com/gantt/api.js']) }}

    <script>

        $('#btn-refresh').click(function(){
            gantt.load(global.ganttApi+'/task/');
        });
        $('body').removeClass('sidebar-collapse');

        gantt.config.grid_width = 0;

        for( var conf in global.ganttSettings.columns) {
            gantt.config.grid_width += parseFloat(global.ganttSettings.columns[conf].width);
        }

        gantt.config.columns  = global.ganttSettings.columns;
        gantt.config.xml_date = "%Y-%m-%d %H:%i:%s";
        gantt.config.readonly = true;

        gantt.init("gantt-container");
        gantt.load(global.ganttApi+'/task/');
    </script>

{% endblock %}
